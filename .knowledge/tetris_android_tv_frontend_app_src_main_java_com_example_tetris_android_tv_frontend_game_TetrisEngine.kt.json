{"is_source_file": true, "format": "Kotlin", "description": "This file implements the core logic of a Tetris game engine, handling piece spawning, movement, rotation, line clearing, scoring, game state management, and hold mechanics. It is independent of Android UI components and provides an immutable snapshot of the game state for UI or testing purposes.", "external_files": [], "external_methods": [], "published": ["ScoreState", "GameSnapshot", "TetrisEngine"], "classes": [{"name": "ScoreState", "description": "Immutable data class capturing the player's current score, level, and total lines cleared."}, {"name": "GameSnapshot", "description": "Immutable data class representing a snapshot of the current game state, including board, active piece, queue, hold, score, and game over status."}, {"name": "TetrisEngine", "description": "Main class implementing the Tetris game logic, managing game state, piece handling, scoring, queue management, hold mechanics, and interactions such as moves and rotations."}], "methods": [{"name": "snapshot", "description": "Returns an immutable snapshot of the current game state."}, {"name": "reset", "description": "Resets the game state to initial settings with optional seed."}, {"name": "tickGravity", "description": "Advances the game by applying gravity to the active piece, locking it if it cannot move down further."}, {"name": "softDrop", "description": "Softly drops the active piece by one row, updating score accordingly."}, {"name": "hardDrop", "description": "Instantly drops the active piece to the lowest position, updating score accordingly, and locks the piece."}, {"name": "moveLeft", "description": "Moves the active piece left if possible."}, {"name": "moveRight", "description": "Moves the active piece right if possible."}, {"name": "rotateCW", "description": "Rotates the active piece clockwise if possible."}, {"name": "rotateCCW", "description": "Rotates the active piece counter-clockwise if possible."}, {"name": "isActiveOnGround", "description": "Checks if the active piece is on the ground (cannot move down)."}, {"name": "tryStepDown", "description": "Attempts to move the active piece down by one without scoring or locking."}, {"name": "hold", "description": "Swaps the active piece with the held piece or sets hold if empty; manages hold restrictions and spawning."}, {"name": "isGameOver", "description": "Checks if the game has ended."}], "calls": ["tryMove", "lockActiveAndProceed", "clearFullLines", "scoreStateAfterClear", "resolveHoldIncoming"], "search-terms": ["TetrisEngine", "core game logic", "hold mechanic", "score state", "line clearing", "piece spawning", "rotation", "collision detection"], "state": 2, "file_id": 18, "knowledge_revision": 50, "git_revision": "9998a2616ea9bf1a3659c6fb947e281f70b2676c", "revision_history": [{"38": ""}, {"40": "1993040eb212919dd2acb3a4ca0a62a027d79fd6"}, {"41": "708797a207bc0a937fdf415b12ce127573b3eb39"}, {"43": "c3d5b600dd7a0cf2f2c269524aef2675df196c50"}, {"44": "6ed720a44c7bc38f592db16e46d68e761d24194e"}, {"46": "b2c64d72cc89a650c6353d3eb488c298b36eccd7"}, {"50": "9998a2616ea9bf1a3659c6fb947e281f70b2676c"}], "hash": "dff011a209af500aac48c3e97cc3c55d", "format-version": 4, "code-base-name": "tetris_android_tv_frontend", "filename": "tetris_android_tv_frontend/app/src/main/java/com/example/tetris_android_tv_frontend/game/TetrisEngine.kt"}