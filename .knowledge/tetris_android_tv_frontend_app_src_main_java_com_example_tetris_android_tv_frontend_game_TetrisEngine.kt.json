{"is_source_file": true, "format": "Kotlin", "description": "This file contains the core logic of a Tetris game engine, independent of any UI framework. It manages game state including the board, active pieces, hold mechanics, scoring, line clearing, and piece spawning, with detailed methods for moving, rotating, hard/soft drops, and game over detection.", "external_files": [], "external_methods": [], "published": ["ScoreState", "GameSnapshot", "TetrisEngine"], "classes": [{"name": "ScoreState", "description": "Data class representing the current score, level, and total lines cleared."}, {"name": "GameSnapshot", "description": "Immutable snapshot of the current game state, including the board, active piece, hold piece, and score."}, {"name": "TetrisEngine", "description": "Main class handling the game logic, piece movement, rotation, collision detection, line clearing, scoring, and game over conditions."}], "methods": [{"name": "snapshot", "description": "Creates an immutable snapshot of the current game state."}, {"name": "reset", "description": "Resets the game state with an optional seed for RNG, clearing the board and initializing the first pieces."}, {"name": "tickGravity", "description": "Advances the active piece downward by one cell if possible, locking it and spawning a new piece if it cannot move further."}, {"name": "softDrop", "description": "Fast drops the active piece downward until it hits a collision, awarding points for each cell moved."}, {"name": "hardDrop", "description": "Hard drops the active piece to the lowest possible position immediately, awarding points accordingly, then locks it in place."}, {"name": "moveLeft", "description": "Attempts to move the active piece one cell to the left."}, {"name": "moveRight", "description": "Attempts to move the active piece one cell to the right."}, {"name": "rotateCW", "description": "Attempts to rotate the active piece clockwise, applying wall kicks if necessary."}, {"name": "rotateCCW", "description": "Attempts to rotate the active piece counter-clockwise, applying wall kicks if necessary."}, {"name": "hold", "description": "Swaps the current active piece with the hold piece, if allowed, and spawns the held piece."}, {"name": "isGameOver", "description": "Indicates whether the game has ended due to a full board."}], "calls": ["tryMove", "lockActiveAndProceed", "clearFullLines", "scoreStateAfterClear", "spawnNext", "nextFromQueue", "ensureQueue", "spawnPosition", "resolveHoldIncoming"], "search-terms": ["TetrisEngine", "core game logic", "piece spawn", "rotation", "line clear", "hold mechanic", "scoring", "7-bag queue", "collision detection", "game over"], "state": 2, "file_id": 18, "knowledge_revision": 41, "git_revision": "708797a207bc0a937fdf415b12ce127573b3eb39", "revision_history": [{"38": ""}, {"40": "1993040eb212919dd2acb3a4ca0a62a027d79fd6"}, {"41": "708797a207bc0a937fdf415b12ce127573b3eb39"}], "hash": "12af752708880df30169244935080d5b", "format-version": 4, "code-base-name": "tetris_android_tv_frontend", "filename": "tetris_android_tv_frontend/app/src/main/java/com/example/tetris_android_tv_frontend/game/TetrisEngine.kt"}