{"is_source_file": true, "format": "Kotlin", "description": "This file contains the core logic of a Tetris game engine, including game state management, piece movements, rotations, line clearance, scoring, and hold mechanics. It is independent of any UI framework and provides an API for gameplay operations and state snapshotting.", "external_files": [], "external_methods": [], "published": ["ScoreState", "GameSnapshot", "TetrisEngine"], "classes": [{"name": "ScoreState", "description": "Immutable data class representing the current score, level, and total lines cleared."}, {"name": "GameSnapshot", "description": "Immutable snapshot of the entire game state, including the board, active piece, queue, hold piece, score, and game over status."}, {"name": "TetrisEngine", "description": "Main game engine class handling all game mechanics such as spawning pieces, moving, rotating, line clearing, scoring, hold feature, and game over detection."}], "methods": [{"name": "snapshot", "description": "Returns the current game state as a GameSnapshot object."}, {"name": "reset", "description": "Resets the game to initial state with an optional seed for RNG."}, {"name": "tickGravity", "description": "Advances the game by applying gravity; moves the active piece down if possible or locks it and spawns a new piece."}, {"name": "softDrop", "description": "Moves the active piece down repeatedly until blocked, increasing score based on cells descended."}, {"name": "hardDrop", "description": "Instantly drops the active piece to the lowest valid position, updating score accordingly and locking the piece."}, {"name": "moveLeft", "description": "Attempts to move the active piece left."}, {"name": "moveRight", "description": "Attempts to move the active piece right."}, {"name": "rotateCW", "description": "Rotates the active piece clockwise if possible."}, {"name": "rotateCCW", "description": "Rotates the active piece counterclockwise if possible."}, {"name": "hold", "description": "Handles the hold mechanic: stores the current piece or swaps with held piece, with game over detection if spawn collides."}, {"name": "isGameOver", "description": "Returns whether the game has ended."}], "calls": ["tryMove", "lockActiveAndProceed", "clearFullLines", "scoreStateAfterClear", "resolveHoldIncoming", "spawnNext"], "search-terms": ["TetrisEngine", "hold mechanic", "7-bag queue", "SRS", "rotation", "piece spawning", "line clearing", "score tracking", "game over detection", "immutable game snapshot"], "state": 2, "file_id": 18, "knowledge_revision": 46, "git_revision": "b2c64d72cc89a650c6353d3eb488c298b36eccd7", "revision_history": [{"38": ""}, {"40": "1993040eb212919dd2acb3a4ca0a62a027d79fd6"}, {"41": "708797a207bc0a937fdf415b12ce127573b3eb39"}, {"43": "c3d5b600dd7a0cf2f2c269524aef2675df196c50"}, {"44": "6ed720a44c7bc38f592db16e46d68e761d24194e"}, {"46": "b2c64d72cc89a650c6353d3eb488c298b36eccd7"}], "hash": "6a29fa10adc6b83d9e4f8efe279ab626", "format-version": 4, "code-base-name": "tetris_android_tv_frontend", "filename": "tetris_android_tv_frontend/app/src/main/java/com/example/tetris_android_tv_frontend/game/TetrisEngine.kt"}