{"is_source_file": true, "format": "Kotlin", "description": "This file contains the core logic of a Tetris game engine, including game state management, piece spawning, movement, rotation, line clearing, scoring, and hold mechanics. It is independent of the Android UI layer, focusing solely on game mechanics.", "external_files": ["com/example/tetris_android_tv_frontend/game/BoardState.kt", "com/example/tetris_android_tv_frontend/game/BoardCell.kt", "com/example/tetris_android_tv_frontend/game/TetrominoType.kt", "com/example/tetris_android_tv_frontend/game/Coord.kt", "com/example/tetris_android_tv_frontend/game/Rotation.kt", "com/example/tetris_android_tv_frontend/game/SRS.kt", "com/example/tetris_android_tv_frontend/game/SevenBagRNG.kt", "com/example/tetris_android_tv_frontend/game/PieceState.kt"], "external_methods": ["SRS.kicks", "SevenBagRNG.next", "SevenBagRNG.reseed"], "published": ["com.example.tetris_android_tv_frontend.game.ScoreState", "com.example.tetris_android_tv_frontend.game.GameSnapshot", "com.example.tetris_android_tv_frontend.game.TetrisEngine"], "classes": [{"name": "ScoreState", "description": "An immutable data class representing the current score, level, and total lines cleared."}, {"name": "GameSnapshot", "description": "An immutable snapshot of the current game state, including the board, active piece, queue, hold, score, and game over status."}, {"name": "TetrisEngine", "description": "The main class implementing core Tetris game mechanics such as piece spawning, movement, rotation, collision detection, line clearing, scoring, and game over detection."}], "methods": [{"name": "snapshot", "description": "Returns a current snapshot of the game state for UI or testing purposes."}, {"name": "reset", "description": "Resets the game to its initial state with an optional seed for RNG."}, {"name": "tickGravity", "description": "Advances the game state by moving the active piece down by gravity. Locks the piece if it cannot move down."}, {"name": "softDrop", "description": "Drops the active piece downward as far as possible instantly, incrementing score based on steps moved."}, {"name": "hardDrop", "description": "Instantly drops the active piece to the lowest possible position, scoring points per cell and locking it."}, {"name": "moveLeft", "description": "Attempts to move the active piece one cell to the left."}, {"name": "moveRight", "description": "Attempts to move the active piece one cell to the right."}, {"name": "rotateCW", "description": "Rotates the active piece clockwise, considering wall kicks."}, {"name": "rotateCCW", "description": "Rotates the active piece counter-clockwise, considering wall kicks."}, {"name": "hold", "description": "Swaps the current active piece with the hold piece if allowed, or stores the current piece in hold."}, {"name": "isGameOver", "description": "Returns true if the game has ended, false otherwise."}], "calls": ["tryMove", "lockActiveAndProceed", "clearFullLines", "scoreStateAfterClear", "resolveHoldIncoming", "spawnNext", "ensureQueue", "nextFromQueue", "spawnPosition", "symmetric", "b.collides", "b.inBounds", "b.set", "BoardState.grid", "BoardState.get"], "search-terms": ["TetrisEngine", "hold mechanics", "piece spawning", "rotation with Kicks", "line clearing", "stack collision detection", "score calculation", "7-bag queue", "game over detection", "immutable game state"], "state": 2, "file_id": 18, "knowledge_revision": 44, "git_revision": "6ed720a44c7bc38f592db16e46d68e761d24194e", "revision_history": [{"38": ""}, {"40": "1993040eb212919dd2acb3a4ca0a62a027d79fd6"}, {"41": "708797a207bc0a937fdf415b12ce127573b3eb39"}, {"43": "c3d5b600dd7a0cf2f2c269524aef2675df196c50"}, {"44": "6ed720a44c7bc38f592db16e46d68e761d24194e"}], "hash": "9d7b9ff91dab6a139bdcab39d72b8c04", "format-version": 4, "code-base-name": "tetris_android_tv_frontend", "filename": "tetris_android_tv_frontend/app/src/main/java/com/example/tetris_android_tv_frontend/game/TetrisEngine.kt"}