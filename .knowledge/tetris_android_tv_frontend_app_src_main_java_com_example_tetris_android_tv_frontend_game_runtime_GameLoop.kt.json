{"is_source_file": true, "format": "Kotlin", "description": "This Kotlin source file defines the GameLoop class, which manages the runtime behavior of a Tetris game engine in an Android TV frontend. It handles gravity updates, lock delays, game state snapshots, pause/resume/reset lifecycle, and emits game events for UI to observe.", "external_files": ["com.example.tetris_android_tv_frontend.game.*", "kotlinx.coroutines.*", "kotlinx.coroutines.flow.*"], "external_methods": ["engine.snapshot()", "engine.reset()", "engine.tickGravity()"], "published": ["GameLoop", "GameEvent"], "classes": [{"name": "GameLoop", "description": "A coroutine-driven runtime controller for the TetrisEngine that manages gravity ticks, lock delays, game lifecycle, and exposes observable flows for UI components."}], "methods": [{"name": "start", "description": "Starts the game loop, initiating gravity ticks if not already running."}, {"name": "stop", "description": "Stops the game loop, cancelling ongoing jobs and halting game updates."}, {"name": "reset", "description": "Resets the Tetris engine to initial state, cancels lock delays, and restarts gravity if game was running."}, {"name": "pause", "description": "Pauses gravity and lock delay progression without altering engine state."}, {"name": "resume", "description": "Resumes gravity and gameplay after being paused."}, {"name": "onPlayerActionAccepted", "description": "To be called when player actions (movement/rotation) are accepted, possibly cancelling pending lock delays."}, {"name": "gravityDelayMs", "description": "Calculates the delay between gravity ticks based on current level, decreasing as level increases."}], "calls": ["engine.snapshot()", "engine.reset()", "engine.tickGravity()", "publishSnapshot()", "handleGameOver()", "externalScope.launch { _events.emit(...)}"], "search-terms": ["GameLoop", "gravity", "lock delay", "TetrisEngine", "game lifecycle", "coroutine game loop", "observable game state", "UI-agnostic", "Android TV Tetris"], "state": 2, "file_id": 20, "knowledge_revision": 52, "git_revision": "", "hash": "92a8f9687992fc5ab73cc6fab72ad64c", "format-version": 4, "code-base-name": "tetris_android_tv_frontend", "filename": "tetris_android_tv_frontend/app/src/main/java/com/example/tetris_android_tv_frontend/game/runtime/GameLoop.kt", "revision_history": [{"52": ""}]}